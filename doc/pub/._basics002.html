<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="A short introduction to scientific Python programming">
<meta name="keywords" content="text editor,program file,assignment statement,print statement,variable,objects,formatting of numbers,printf syntax,format string syntax,while loop,boolean expression,Python Online Tutor,list,for loop,list comprehension,array,mathematical functions,import of modules,plotting,graphics,visualization,function (in Python),global variables,keyword arguments,default arguments,vectorization,vectorized functions,multiple return values,branching,if test,boolean expression,vectorizing if tests,linear systems,sparse matrix,tridigonal matrix">

<title>A short introduction to scientific Python programming</title>

<!-- Bootstrap style: bootstrap -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              (u'Variables, loops, lists, and arrays',
               1,
               u'basics:basic:objects',
               u'basics:basic:objects'),
              (u'Getting access to Python',
               2,
               u'basics:accesspy',
               u'basics:accesspy'),
              (u'Mac and Windows', 3, None, '___sec2'),
              (u'Ubuntu', 3, None, '___sec3'),
              (u'Web access', 3, None, '___sec4'),
              (u'Mathematical example', 2, None, '___sec5'),
              (u'A program for evaluating a formula',
               2,
               u'basics:formula:eval',
               u'basics:formula:eval'),
              (u'Formatted output with text and numbers',
               2,
               u'basics:printf',
               u'basics:printf'),
              (u'While loops', 2, u'basics:while', u'basics:while'),
              (u'Lists', 2, u'basics:list', u'basics:list'),
              (u'For loops', 2, u'basics:for', u'basics:for'),
              (u'Arrays', 2, u'basics:numpy', u'basics:numpy'),
              (u'Mathematical functions', 2, u'basics:math', u'basics:math'),
              (u'Plotting', 2, u'basics:plot', u'basics:plot'),
              (u'Functions and branching',
               1,
               u'basics:func:branching',
               u'basics:func:branching'),
              (u'Functions', 2, u'basics:func', u'basics:func'),
              (u'A more general mathematical formula',
               2,
               u'basics:formula:piecewise',
               u'basics:formula:piecewise'),
              (u'If tests', 2, u'basics:if', u'basics:if'),
              (u'Using the `where` function', 3, None, '___sec18'),
              (u'Using array indexing', 3, None, '___sec19'),
              (u'Array view versus array copying', 2, None, '___sec20'),
              (u'Linear systems', 2, None, '___sec21'),
              (u'Files', 1, u'basics:files', u'basics:files'),
              (u'File reading', 2, None, '___sec23'),
              (u'File writing', 2, None, '___sec24'),
              (u'Classes', 1, u'basics:class', u'basics:class'),
              (u'A very simple class', 2, None, '___sec26'),
              (u'A class for representing a mathematical function',
               2,
               None,
               '___sec27'),
              (u'The class code', 3, None, '___sec28'),
              (u'Dissection', 3, None, '___sec29'),
              (u'Exercises', 1, u'basics:exer', u'basics:exer'),
              (u'Exercise 1: Program a formula',
               2,
               u'basics:exer:formula1',
               u'basics:exer:formula1'),
              (u'Exercise 2: Combine text and numbers in output',
               2,
               u'basics:exer:printf1',
               u'basics:exer:printf1'),
              (u'Exercise 3: Program a while loop',
               2,
               u'basics:exer:while1',
               u'basics:exer:while1'),
              (u'Exercise 4: Create a list with a while loop',
               2,
               u'basics:exer:while2',
               u'basics:exer:while2'),
              (u'Exercise 5: Program a for loop',
               2,
               u'basics:exer:for1',
               u'basics:exer:for1'),
              (u'Exercise 6: Write a Python function',
               2,
               u'basics:exer:func1',
               u'basics:exer:func1'),
              (u'Exercise 7: Return three values from a Python function',
               2,
               u'basics:exer:func3',
               u'basics:exer:func3'),
              (u'Exercise 8: Plot a function',
               2,
               u'basics:exer:plot1',
               u'basics:exer:plot1'),
              (u'Exercise 9: Plot two functions',
               2,
               u'basics:exer:plot2',
               u'basics:exer:plot2'),
              (u'Exercise 10: Measure the efficiency of vectorization',
               2,
               u'basics:exer:timeit',
               u'basics:exer:timeit')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="basics.html">A short introduction to scientific Python programming</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._basics000.html#table_of_contents" style="font-size: 80%;"><b>Table of contents</b></a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:basic:objects" style="font-size: 80%;"><b>Variables, loops, lists, and arrays</b></a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:accesspy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Getting access to Python</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#___sec2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mac and Windows</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#___sec3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ubuntu</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#___sec4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Web access</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#___sec5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Mathematical example</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:formula:eval" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A program for evaluating a formula</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:printf" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Formatted output with text and numbers</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:while" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;While loops</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:list" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Lists</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:for" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;For loops</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:numpy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Arrays</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:math" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Mathematical functions</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:plot" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Plotting</a></li>
     <!-- navigation toc: --> <li><a href="#basics:func:branching" style="font-size: 80%;"><b>Functions and branching</b></a></li>
     <!-- navigation toc: --> <li><a href="#basics:func" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Functions</a></li>
     <!-- navigation toc: --> <li><a href="#basics:formula:piecewise" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A more general mathematical formula</a></li>
     <!-- navigation toc: --> <li><a href="#basics:if" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;If tests</a></li>
     <!-- navigation toc: --> <li><a href="#___sec18" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using the <code>where</code> function</a></li>
     <!-- navigation toc: --> <li><a href="#___sec19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using array indexing</a></li>
     <!-- navigation toc: --> <li><a href="#___sec20" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Array view versus array copying</a></li>
     <!-- navigation toc: --> <li><a href="#___sec21" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Linear systems</a></li>
     <!-- navigation toc: --> <li><a href="._basics003.html#basics:files" style="font-size: 80%;"><b>Files</b></a></li>
     <!-- navigation toc: --> <li><a href="._basics003.html#___sec23" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;File reading</a></li>
     <!-- navigation toc: --> <li><a href="._basics003.html#___sec24" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;File writing</a></li>
     <!-- navigation toc: --> <li><a href="._basics004.html#basics:class" style="font-size: 80%;"><b>Classes</b></a></li>
     <!-- navigation toc: --> <li><a href="._basics004.html#___sec26" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A very simple class</a></li>
     <!-- navigation toc: --> <li><a href="._basics004.html#___sec27" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A class for representing a mathematical function</a></li>
     <!-- navigation toc: --> <li><a href="._basics004.html#___sec28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The class code</a></li>
     <!-- navigation toc: --> <li><a href="._basics004.html#___sec29" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dissection</a></li>
     <!-- navigation toc: --> <li><a href="._basics005.html#basics:exer" style="font-size: 80%;"><b>Exercises</b></a></li>
     <!-- navigation toc: --> <li><a href="._basics005.html#basics:exer:formula1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 1: Program a formula</a></li>
     <!-- navigation toc: --> <li><a href="._basics005.html#basics:exer:printf1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 2: Combine text and numbers in output</a></li>
     <!-- navigation toc: --> <li><a href="._basics005.html#basics:exer:while1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 3: Program a while loop</a></li>
     <!-- navigation toc: --> <li><a href="._basics005.html#basics:exer:while2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 4: Create a list with a while loop</a></li>
     <!-- navigation toc: --> <li><a href="._basics005.html#basics:exer:for1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 5: Program a for loop</a></li>
     <!-- navigation toc: --> <li><a href="._basics005.html#basics:exer:func1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 6: Write a Python function</a></li>
     <!-- navigation toc: --> <li><a href="._basics005.html#basics:exer:func3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 7: Return three values from a Python function</a></li>
     <!-- navigation toc: --> <li><a href="._basics005.html#basics:exer:plot1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 8: Plot a function</a></li>
     <!-- navigation toc: --> <li><a href="._basics005.html#basics:exer:plot2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 9: Plot two functions</a></li>
     <!-- navigation toc: --> <li><a href="._basics005.html#basics:exer:timeit" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 10: Measure the efficiency of vectorization</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0002"></a>
<!-- !split -->

<h1 id="basics:func:branching" class="anchor">Functions and branching</h1>

<h2 id="basics:func" class="anchor">Functions</h2>

<p>
Since \( s(t) \) is a function in mathematics, it is convenient to have
it as a function in Python too:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">s</span>(t):
    <span style="color: #008000; font-weight: bold">return</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>

v0 <span style="color: #666666">=</span> <span style="color: #666666">0.2</span>
a <span style="color: #666666">=</span> <span style="color: #666666">4</span>
value <span style="color: #666666">=</span> s(<span style="color: #666666">3</span>)   <span style="color: #408080; font-style: italic"># Call the function</span>
</pre></div>
<p>
Note that

<ul>
 <li> functions start with the keyword <code>def</code></li>
 <li> statements belonging to the function must be indented</li>
 <li> function input is represented by arguments
   (separated by comma if more than one)</li>
 <li> function output is returned to the calling code</li>
</ul>

In this program, <code>v0</code> and <code>a</code> are <em>global variables</em>, which must be
defined before calling the <code>s(t)</code> function, otherwise <code>v0</code> and <code>a</code>
becomes undefined variables in the expression inside the function.

<p>
Instead of having <code>v0</code> and <code>a</code> as global variables, we may let them be
function arguments:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">s</span>(t, v0, a):
    <span style="color: #008000; font-weight: bold">return</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>

value <span style="color: #666666">=</span> s(<span style="color: #666666">3</span>, <span style="color: #666666">0.2</span>, <span style="color: #666666">4</span>)   <span style="color: #408080; font-style: italic"># Call the function</span>

<span style="color: #408080; font-style: italic"># More readable call</span>
value <span style="color: #666666">=</span> s(t<span style="color: #666666">=3</span>, v0<span style="color: #666666">=0.2</span>, a<span style="color: #666666">=4</span>)
</pre></div>
<p>
Function arguments may also be declared to have a default value,
allowing us to drop the argument in the call if the default value
is appropriate. Such arguments are called <em>keyword arguments</em> or
<em>default arguments</em>. Here is an example:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">s</span>(t, v0<span style="color: #666666">=1</span>, a<span style="color: #666666">=1</span>):
    <span style="color: #008000; font-weight: bold">return</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>

value <span style="color: #666666">=</span> s(<span style="color: #666666">3</span>, <span style="color: #666666">0.2</span>, <span style="color: #666666">4</span>)         <span style="color: #408080; font-style: italic"># specify new v0 and a</span>
value <span style="color: #666666">=</span> s(<span style="color: #666666">3</span>)                 <span style="color: #408080; font-style: italic"># rely on v0=1 and a=1</span>
value <span style="color: #666666">=</span> s(<span style="color: #666666">3</span>, a<span style="color: #666666">=2</span>)            <span style="color: #408080; font-style: italic"># rely on v0=1</span>
value <span style="color: #666666">=</span> s(<span style="color: #666666">3</span>, v0<span style="color: #666666">=2</span>)           <span style="color: #408080; font-style: italic"># rely on a=1</span>
value <span style="color: #666666">=</span> s(t<span style="color: #666666">=3</span>, v0<span style="color: #666666">=2</span>, a<span style="color: #666666">=2</span>)    <span style="color: #408080; font-style: italic"># specify everything</span>
value <span style="color: #666666">=</span> s(a<span style="color: #666666">=2</span>, t<span style="color: #666666">=3</span>, v0<span style="color: #666666">=2</span>)    <span style="color: #408080; font-style: italic"># any sequence allowed</span>
</pre></div>
<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Notice.</b>

<ul>
 <li> Arguments without the argument name are called <em>positional arguments</em>.</li>
 <li> Positional arguments must always be listed before the keyword arguments
   in the function and in any call.</li>
 <li> The sequence of the keyword arguments can be arbitrary.</li>
 <li> If argument names are used for all arguments (as in the last line above)
   the sequence of the arguments is not important.</li>
</ul>
</div>


<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Vectorized functions.</b>
Applying the function <code>s(t, v0, a)</code> to an array <code>t</code> can be done
in two ways:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># Scalar code: work with one element at a time</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(t)):
    s_values[i] <span style="color: #666666">=</span> s(t_values[i], v0, a)

<span style="color: #408080; font-style: italic"># Vectorized code: apply s to the entire array</span>
s_values <span style="color: #666666">=</span> s(t_values, v0, a)
</pre></div>
<p>
For the last line to work, the function <code>s</code> must contain statements
that work correctly when <code>t</code> is an array argument.

<p>
The advantage of vectorized code is that we avoid a loop in Python.
Instead, we carry out mathematical operations on entire arrays, e.g.,
<code>v0*t</code> and <code>a*t**2</code>. Technically, such (binary) operations are
executed as loops in very fast (compiled) C code.
</div>


<p>
A function can return more than one value, say \( s(t) \) and the
velocity \( s'(t)=v_0 + at \):

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">movement</span>(t, v0, a):
    s <span style="color: #666666">=</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>
    v <span style="color: #666666">=</span> v0 <span style="color: #666666">+</span> a<span style="color: #666666">*</span>t
    <span style="color: #008000; font-weight: bold">return</span> s, v

s_value, v_value <span style="color: #666666">=</span> movement(t<span style="color: #666666">=0.2</span>, v0<span style="color: #666666">=2</span>, a<span style="color: #666666">=4</span>)
</pre></div>
<p>
When \( n \) values are returned, we list \( n \) variables on the left-hand
side in the call.

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Python functions return only one object.</b>
Even when we return several values, as in <code>return s, v</code>, actually only
one object is returned. The <code>s</code> and <code>v</code> values are packed together
in a <em>tuple</em> object (which is very similar to a list).

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">+1</span>, x<span style="color: #666666">+2</span>, x<span style="color: #666666">+3</span>
<span style="color: #666666">...</span>
<span style="color: #666666">&gt;&gt;&gt;</span> r <span style="color: #666666">=</span> f(<span style="color: #666666">3</span>)     <span style="color: #408080; font-style: italic"># Store all three return values in one object r</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span>(r)
(<span style="color: #666666">4</span>, <span style="color: #666666">5</span>, <span style="color: #666666">6</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">type</span>(r)      <span style="color: #408080; font-style: italic"># What type of object is r?</span>
<span style="color: #666666">&lt;</span><span style="color: #008000">type</span> <span style="color: #BA2121">&#39;tuple&#39;</span><span style="color: #666666">&gt;</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span>(r[<span style="color: #666666">1</span>])
<span style="color: #666666">5</span>
</pre></div>
<p>
Tuples are constant lists, so you can index them as lists, but you cannot
change the contents (<code>append</code> or <code>del</code> is illegal).
</div>


<h2 id="basics:formula:piecewise" class="anchor">A more general mathematical formula</h2>

<p>
The formula <a href="._basics001.html#mjx-eqn-1">(1)</a> arises from the basic differential
equations in kinematics:

$$
\begin{align}
v = \frac{ds}{dt},\quad s(0)=s_0,
\tag{2}\\ 
a = \frac{dv}{dt},\quad v(0)=v_0\thinspace .
\tag{3}
\end{align}
$$

Given any acceleration \( a(t) \), we can solve for \( s(t) \) through integration.
First, we integrate to find \( v(t) \):

$$ \int_0^t a(t)dt = \int_0^t \frac{dv}{dt} dt,$$

which gives

$$ v(t) = v_0 + \int_0^t a(t)dt\thinspace . $$

Then we integrate again over \( [0,t] \) to find \( s(t) \):

$$
\begin{equation}
s(t) = s_0 + v_0t + \int_0^t\left( \int_0^t a(t)dt \right) dt\thinspace .
\tag{4}
\end{equation}
$$

<p>
Suppose we have some constant acceleration \( a_0 \) in \( [0,t_1] \) and no
acceleration thereafter. We find

$$
\begin{equation}
s(t) = \left\lbrace\begin{array}{ll}
s_0 + v_0 t + \frac{1}{2}a_0 t^2,& t\leq t_1\\ 
s_0 + v_0t_1 + \frac{1}{2}a_0 t_1^2 + a_0t_1(t-t_1),& t> t_1
\end{array}\right.
\tag{5}
\end{equation}
$$

<p>
To implement a function like <a href="#mjx-eqn-5">(5)</a>, we need to
branch into one type of code (formula) if \( t\leq t_1 \) and another
type of code (formula) if \( t>t_1 \). This is called <em>branching</em> and
the <em>if test</em> is the primary construction to use.

<h2 id="basics:if" class="anchor">If tests</h2>

<p>
An if test has the structure

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">if</span> condition:
    <span style="color: #666666">&lt;</span>statements when condition <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">True</span><span style="color: #666666">&gt;</span>
<span style="color: #008000; font-weight: bold">else</span>:
    <span style="color: #666666">&lt;</span>statements when condition <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">False</span><span style="color: #666666">&gt;</span>
</pre></div>
<p>
Here, <code>condition</code> is a boolean expression that evaluates to <code>True</code> or
<code>False</code>. For the piecewisely defined function <a href="#mjx-eqn-5">(5)</a>
we would use an if test in the implementation:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">if</span> t <span style="color: #666666">&lt;=</span> t1:
    s <span style="color: #666666">=</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>
<span style="color: #008000; font-weight: bold">else</span>:
    s <span style="color: #666666">=</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t1<span style="color: #666666">**2</span> <span style="color: #666666">+</span> a0<span style="color: #666666">*</span>t1<span style="color: #666666">*</span>(t<span style="color: #666666">-</span>t1)
</pre></div>
<p>
The <code>else</code> part can be omitted when not needed. Several branches are
also possible:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">if</span> condition1:
    <span style="color: #666666">&lt;</span>statements when condition1 <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">True</span><span style="color: #666666">&gt;</span>
<span style="color: #008000; font-weight: bold">elif</span> condition2:
    <span style="color: #666666">&lt;</span>statements when condition1 <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">False</span> <span style="color: #AA22FF; font-weight: bold">and</span> condition2 <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">True</span><span style="color: #666666">&gt;</span>
<span style="color: #008000; font-weight: bold">elif</span> condition3:
    <span style="color: #666666">&lt;</span>statements when condition1 <span style="color: #AA22FF; font-weight: bold">and</span> conditon <span style="color: #666666">2</span> are <span style="color: #008000">False</span>
     <span style="color: #AA22FF; font-weight: bold">and</span> condition3 <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">True</span><span style="color: #666666">&gt;</span>
<span style="color: #008000; font-weight: bold">else</span>:
    <span style="color: #666666">&lt;</span>statements when condition1<span style="color: #666666">/2/3</span> <span style="color: #008000">all</span> are <span style="color: #008000">False</span><span style="color: #666666">&gt;</span>
</pre></div>
<p>
A Python function implementing the mathematical function <a href="#mjx-eqn-5">(5)</a>
reads

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">s_func</span>(t, v0, a0, t1):
    <span style="color: #008000; font-weight: bold">if</span> t <span style="color: #666666">&lt;=</span> t1:
        s <span style="color: #666666">=</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>
    <span style="color: #008000; font-weight: bold">else</span>:
        s <span style="color: #666666">=</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t1<span style="color: #666666">**2</span> <span style="color: #666666">+</span> a0<span style="color: #666666">*</span>t1<span style="color: #666666">*</span>(t<span style="color: #666666">-</span>t1)
    <span style="color: #008000; font-weight: bold">return</span> s
</pre></div>
<p>
To plot this \( s(t) \), we need to compute points on the curve.
Trying to call <code>s_func</code> with an array <code>t</code> as argument will not
work because of the if test. In general, functions with if tests
will not automatically work with arrays because a test
like <code>if t &lt;= t1</code> evaluates to an if applied to a boolean
array (<code>t &lt;= t1</code> becomes a boolean array, not just a boolean).

<p>
One solution is to compute the function values one by one in a loop
such that the <code>s</code> function is always called with a scalar value for <code>t</code>.
Appropriate code is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>n <span style="color: #666666">=</span> <span style="color: #666666">201</span>  <span style="color: #408080; font-style: italic"># No of t values for plotting</span>
t1 <span style="color: #666666">=</span> <span style="color: #666666">1.5</span>

t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">2</span>, n<span style="color: #666666">+1</span>)
s <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(n<span style="color: #666666">+1</span>)
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(t)):
    s[i] <span style="color: #666666">=</span> s_func(t<span style="color: #666666">=</span>t[i], v0<span style="color: #666666">=0.2</span>, a0<span style="color: #666666">=20</span>, t1<span style="color: #666666">=</span>t1)
</pre></div>
<p>
Relevant statements for plotting are now

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>plt<span style="color: #666666">.</span>plot(t, s, <span style="color: #BA2121">&#39;b-&#39;</span>)
plt<span style="color: #666666">.</span>plot([t1, t1], [<span style="color: #666666">0</span>, s_func(t<span style="color: #666666">=</span>t1, v0<span style="color: #666666">=0.2</span>, a0<span style="color: #666666">=20</span>, t1<span style="color: #666666">=</span>t1)], <span style="color: #BA2121">&#39;r--&#39;</span>)
plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;t&#39;</span>)
plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;s&#39;</span>)
plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;myplot.png&#39;</span>)
plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Vectorization of functions with if tests.</b>
To vectorize the computation of the array of \( s(t) \) values, i.e.,
avoid a loop where <code>s_func</code> is called for each <code>t[i]</code> element,
we must completely rewrite the if test. There are two methods:
the <code>numpy.where</code> function and array indexing.

<h3 id="___sec18" class="anchor">Using the <code>where</code> function </h3>

<p>
A vectorized if-else test can be coded as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>s <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(condition, s1, s2)
</pre></div>
<p>
Here, <code>condition</code> is an array of boolean values, and
<code>s[i] = s1[i]</code> if <code>condition[i]</code> is <code>True</code>, and otherwise <code>s[i] = s2[i]</code>.

<p>
Our example then becomes

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>s <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(t <span style="color: #666666">&lt;=</span> t1,
             v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>,
             v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t1<span style="color: #666666">**2</span> <span style="color: #666666">+</span> a0<span style="color: #666666">*</span>t1<span style="color: #666666">*</span>(t<span style="color: #666666">-</span>t1))
</pre></div>
<p>
Note that <code>t &lt;= t1</code> with array <code>t</code> and scalar <code>t1</code> results in a boolean
array <code>b</code> where <code>b[i] = t[i] &lt;= t1</code>.

<h3 id="___sec19" class="anchor">Using array indexing </h3>

<p>
It is possible to index a subset of indices in an array <code>s</code> using
a boolean array <code>b</code>: <code>s[b]</code>. This construction picks out all the
elements <code>s[i]</code> where <code>b[i]</code> is <code>True</code>. On the right-hand side
we can then assign some array expression <code>expr</code> of the same length
as <code>s[b]</code>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>s[b] <span style="color: #666666">=</span> (expr)[b]
</pre></div>
<p>
Our example can utilize this technique with <code>b</code> as <code>t &lt;= t1</code> and <code>t &gt; t1</code>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>s <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros_like(t)  <span style="color: #408080; font-style: italic"># Make s as zeros, same size &amp; type as t</span>
s[t <span style="color: #666666">&lt;=</span> t1] <span style="color: #666666">=</span> (v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>)[t <span style="color: #666666">&lt;=</span> t1]
s[t <span style="color: #666666">&gt;</span> t1]  <span style="color: #666666">=</span> (v0<span style="color: #666666">*</span>t <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>a0<span style="color: #666666">*</span>t1<span style="color: #666666">**2</span> <span style="color: #666666">+</span> a0<span style="color: #666666">*</span>t1<span style="color: #666666">*</span>(t<span style="color: #666666">-</span>t1))[t <span style="color: #666666">&gt;</span> t1]
</pre></div>
<p>
</div>


<h2 id="___sec20" class="anchor">Array view versus array copying </h2>

<p>
Arrays are usually large and most array libraries have carefully designed
functionality for avoiding unnecessary copying of large of amounts of data.
If you do a simple assignment,

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>a <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">1</span>, <span style="color: #666666">5</span>, <span style="color: #666666">5</span>)
b <span style="color: #666666">=</span> a
</pre></div>
<p>
<code>b</code> becomes a just <em>view</em> of <code>a</code>: the variables <code>b</code> and <code>a</code> point
to the same data. In other languages one may say that <code>b</code> is a
pointer or reference to the array. This means that changing <code>a</code> changes
<code>b</code> and vice versa:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>array([ <span style="color: #666666">1.</span>,  <span style="color: #666666">2.</span>,  <span style="color: #666666">3.</span>,  <span style="color: #666666">4.</span>,  <span style="color: #666666">5.</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> b[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> <span style="color: #666666">5</span>                       <span style="color: #408080; font-style: italic"># changes a[0] to 5</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a
array([ <span style="color: #666666">5.</span>,  <span style="color: #666666">2.</span>,  <span style="color: #666666">3.</span>,  <span style="color: #666666">4.</span>,  <span style="color: #666666">5.</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> a[<span style="color: #666666">1</span>] <span style="color: #666666">=</span> <span style="color: #666666">9</span>                       <span style="color: #408080; font-style: italic"># changes b[1] to 9</span>
<span style="color: #666666">&gt;&gt;&gt;</span> b
array([ <span style="color: #666666">5.</span>,  <span style="color: #666666">9.</span>,  <span style="color: #666666">3.</span>,  <span style="color: #666666">4.</span>,  <span style="color: #666666">5.</span>])
</pre></div>
<p>
Similarly, <code>b[1:-1]</code> gives a view to a subset of <code>a</code> and no copy of data.
If we want to change <code>b</code> without affecting <code>a</code>, a copy of the array
is required:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> c <span style="color: #666666">=</span> a<span style="color: #666666">.</span>copy()       <span style="color: #408080; font-style: italic"># copy all elements to new array c</span>
<span style="color: #666666">&gt;&gt;&gt;</span> c[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> <span style="color: #666666">6</span>           <span style="color: #408080; font-style: italic"># a is not changed</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a
array([ <span style="color: #666666">1.</span>,  <span style="color: #666666">2.</span>,  <span style="color: #666666">3.</span>,  <span style="color: #666666">4.</span>,  <span style="color: #666666">5.</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> c
array([ <span style="color: #666666">6.</span>,  <span style="color: #666666">2.</span>,  <span style="color: #666666">3.</span>,  <span style="color: #666666">4.</span>,  <span style="color: #666666">5.</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> b
array([ <span style="color: #666666">5.</span>,  <span style="color: #666666">2.</span>,  <span style="color: #666666">3.</span>,  <span style="color: #666666">4.</span>,  <span style="color: #666666">5.</span>])
</pre></div>
<p>
Note that <code>b</code> remains unchanged by the change in <code>c</code> since the <code>b</code> and <code>c</code>
variables now refer to different data. Copying of the elements of a sub-array
is also done by the <code>copy()</code> method: <code>b = a[1:-1].copy()</code>.

<p>
<div class="alert alert-block alert-danger alert-text-normal"><b>Understand the difference between view and copy!</b>
Mathematical errors and/or inefficient code may easily arise from
confusion between array view and array copying. Make sure you
understand the implication of any variable assignment to arrays!

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>a <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">-1</span>, <span style="color: #666666">4.5</span>, <span style="color: #666666">8</span>, <span style="color: #666666">9</span>])
b <span style="color: #666666">=</span> a[<span style="color: #666666">1</span>:<span style="color: #666666">-2</span>]            <span style="color: #408080; font-style: italic"># view: changes in a are reflected in b</span>
b <span style="color: #666666">=</span> a[<span style="color: #666666">1</span>:<span style="color: #666666">-2</span>]<span style="color: #666666">.</span>copy()     <span style="color: #408080; font-style: italic"># copy: changes in a are not reflected in b</span>
</pre></div>
<p>
</div>


<h2 id="___sec21" class="anchor">Linear systems </h2>

<p>
Solving linear systems of the form \( Ax=b \) with a matrix \( A \) and vectors
\( x \) and \( b \) is a frequently encountered task. A sample \( 2\times 2 \) system
can be coded as

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
A <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([[<span style="color: #666666">1.</span>, <span style="color: #666666">2</span>],
              [<span style="color: #666666">4</span>,  <span style="color: #666666">2</span>]])
b <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">1.</span>, <span style="color: #666666">-2</span>])
x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linalg<span style="color: #666666">.</span>solve(A, b)
</pre></div>
<p>
Many scientific computing problems involves large matrices with special
<em>sparse</em> structures. Significant memory and computing time can be
saved by utilizing <em>sparse matrix</em> data structures and associated
algorithms.
Python has sparse matrix package <a href="http://docs.scipy.org/doc/scipy/reference/sparse.html" target="_self">scipy.sparse</a> that can be used to construct
various types of sparse matrices. The particular
function <code>scipy.sparse.spdiags</code> can construct a sparse matrix from
a few vectors representing the diagonals in the matrix
(all the diagonals must have the same length as the dimension of their
sparse matrix, consequently some elements of the diagonals are not used:
the first \( k \) elements are not used of the \( k \) super-diagonal, and
the last  \( k \) elements are not used of the \( -k \) sub-diagonal).
Here is an example of constructing a <em>tridiagonal</em> matrix:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #666666">&gt;&gt;&gt;</span> N <span style="color: #666666">=</span> <span style="color: #666666">6</span>
<span style="color: #666666">&gt;&gt;&gt;</span> diagonals <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((<span style="color: #666666">3</span>, N))   <span style="color: #408080; font-style: italic"># 3 diagonals</span>
diagonals[<span style="color: #666666">0</span>,:] <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">-1</span>, <span style="color: #666666">-</span>N, N)
diagonals[<span style="color: #666666">1</span>,:] <span style="color: #666666">=</span> <span style="color: #666666">-2</span>
diagonals[<span style="color: #666666">2</span>,:] <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">1</span>, N, N)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">scipy.sparse</span>
<span style="color: #666666">&gt;&gt;&gt;</span> A <span style="color: #666666">=</span> scipy<span style="color: #666666">.</span>sparse<span style="color: #666666">.</span>spdiags(diagonals, [<span style="color: #666666">-1</span>,<span style="color: #666666">0</span>,<span style="color: #666666">1</span>], N, N, format<span style="color: #666666">=</span><span style="color: #BA2121">&#39;csc&#39;</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> A<span style="color: #666666">.</span>toarray()    <span style="color: #408080; font-style: italic"># look at corresponding dense matrix</span>
[[<span style="color: #666666">-2.</span>  <span style="color: #666666">2.</span>  <span style="color: #666666">0.</span>  <span style="color: #666666">0.</span>  <span style="color: #666666">0.</span>  <span style="color: #666666">0.</span>]
 [<span style="color: #666666">-1.</span> <span style="color: #666666">-2.</span>  <span style="color: #666666">3.</span>  <span style="color: #666666">0.</span>  <span style="color: #666666">0.</span>  <span style="color: #666666">0.</span>]
 [ <span style="color: #666666">0.</span> <span style="color: #666666">-2.</span> <span style="color: #666666">-2.</span>  <span style="color: #666666">4.</span>  <span style="color: #666666">0.</span>  <span style="color: #666666">0.</span>]
 [ <span style="color: #666666">0.</span>  <span style="color: #666666">0.</span> <span style="color: #666666">-3.</span> <span style="color: #666666">-2.</span>  <span style="color: #666666">5.</span>  <span style="color: #666666">0.</span>]
 [ <span style="color: #666666">0.</span>  <span style="color: #666666">0.</span>  <span style="color: #666666">0.</span> <span style="color: #666666">-4.</span> <span style="color: #666666">-2.</span>  <span style="color: #666666">6.</span>]
 [ <span style="color: #666666">0.</span>  <span style="color: #666666">0.</span>  <span style="color: #666666">0.</span>  <span style="color: #666666">0.</span> <span style="color: #666666">-5.</span> <span style="color: #666666">-2.</span>]]
</pre></div>
<p>
Solving a linear system with a tridiagonal coefficient matrix requires
a special function with a special algorithm to take advantage of
the matrix' structure. The next example chooses a solution <code>x</code>,
computes the corresponding right-hand side \( b=Ax \) using the
sparse matrix vector product associated with the sparse matrix \( A \),
and then solves \( Ax=b \):

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>, N)  <span style="color: #408080; font-style: italic"># choose solution</span>
<span style="color: #666666">&gt;&gt;&gt;</span> b <span style="color: #666666">=</span> A<span style="color: #666666">.</span>dot(x)               <span style="color: #408080; font-style: italic"># sparse matrix vector product</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">scipy.sparse.linalg</span>
<span style="color: #666666">&gt;&gt;&gt;</span> x <span style="color: #666666">=</span> scipy<span style="color: #666666">.</span>sparse<span style="color: #666666">.</span>linalg<span style="color: #666666">.</span>spsolve(A, b)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span>(x)
[<span style="color: #666666">-1.</span>  <span style="color: #666666">-0.6</span> <span style="color: #666666">-0.2</span>  <span style="color: #666666">0.2</span>  <span style="color: #666666">0.6</span>  <span style="color: #666666">1.</span> ]
</pre></div>
<p>
Although we can easily check that <code>x</code> is correctly computed, we can
do another check by converting the linear system to its dense
counterpart:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> A_d <span style="color: #666666">=</span> A<span style="color: #666666">.</span>toarray()            <span style="color: #408080; font-style: italic"># corresponding dense matrix</span>
<span style="color: #666666">&gt;&gt;&gt;</span> b <span style="color: #666666">=</span> np<span style="color: #666666">.</span>dot(A_d, x)           <span style="color: #408080; font-style: italic"># standard matrix vector product</span>
<span style="color: #666666">&gt;&gt;&gt;</span> x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linalg<span style="color: #666666">.</span>solve(A_d, b)  <span style="color: #408080; font-style: italic"># standard Ax=b algorithm</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span>(x)
[<span style="color: #666666">-1.</span>  <span style="color: #666666">-0.6</span> <span style="color: #666666">-0.2</span>  <span style="color: #666666">0.2</span>  <span style="color: #666666">0.6</span>  <span style="color: #666666">1.</span> ]
</pre></div>
<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._basics001.html">&laquo;</a></li>
  <li><a href="._basics000.html">1</a></li>
  <li><a href="._basics001.html">2</a></li>
  <li class="active"><a href="._basics002.html">3</a></li>
  <li><a href="._basics003.html">4</a></li>
  <li><a href="._basics004.html">5</a></li>
  <li><a href="._basics005.html">6</a></li>
  <li><a href="._basics003.html">&raquo;</a></li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

