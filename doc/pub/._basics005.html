<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="A short introduction to scientific Python programming">
<meta name="keywords" content="text editor,program file,assignment statement,print statement,variable,objects,formatting of numbers,printf syntax,format string syntax,while loop,boolean expression,Python Online Tutor,list,for loop,list comprehension,array,mathematical functions,import of modules,plotting,graphics,visualization,function (in Python),global variables,keyword arguments,default arguments,vectorization,vectorized functions,multiple return values,branching,if test,boolean expression,vectorizing if tests,linear systems,sparse matrix,tridigonal matrix">

<title>A short introduction to scientific Python programming</title>

<!-- Bootstrap style: bootstrap -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              (u'Variables, loops, lists, and arrays',
               1,
               u'basics:basic:objects',
               u'basics:basic:objects'),
              (u'Getting access to Python',
               2,
               u'basics:accesspy',
               u'basics:accesspy'),
              (u'Mac and Windows', 3, None, '___sec2'),
              (u'Ubuntu', 3, None, '___sec3'),
              (u'Web access', 3, None, '___sec4'),
              (u'Mathematical example', 2, None, '___sec5'),
              (u'A program for evaluating a formula',
               2,
               u'basics:formula:eval',
               u'basics:formula:eval'),
              (u'Formatted output with text and numbers',
               2,
               u'basics:printf',
               u'basics:printf'),
              (u'While loops', 2, u'basics:while', u'basics:while'),
              (u'Lists', 2, u'basics:list', u'basics:list'),
              (u'For loops', 2, u'basics:for', u'basics:for'),
              (u'Arrays', 2, u'basics:numpy', u'basics:numpy'),
              (u'Mathematical functions', 2, u'basics:math', u'basics:math'),
              (u'Plotting', 2, u'basics:plot', u'basics:plot'),
              (u'Functions and branching',
               1,
               u'basics:func:branching',
               u'basics:func:branching'),
              (u'Functions', 2, u'basics:func', u'basics:func'),
              (u'A more general mathematical formula',
               2,
               u'basics:formula:piecewise',
               u'basics:formula:piecewise'),
              (u'If tests', 2, u'basics:if', u'basics:if'),
              (u'Using the `where` function', 3, None, '___sec18'),
              (u'Using array indexing', 3, None, '___sec19'),
              (u'Array view versus array copying', 2, None, '___sec20'),
              (u'Linear systems', 2, None, '___sec21'),
              (u'Files', 1, u'basics:files', u'basics:files'),
              (u'File reading', 2, None, '___sec23'),
              (u'File writing', 2, None, '___sec24'),
              (u'Classes', 1, u'basics:class', u'basics:class'),
              (u'A very simple class', 2, None, '___sec26'),
              (u'A class for representing a mathematical function',
               2,
               None,
               '___sec27'),
              (u'The class code', 3, None, '___sec28'),
              (u'Dissection', 3, None, '___sec29'),
              (u'Exercises', 1, u'basics:exer', u'basics:exer'),
              (u'Exercise 1: Program a formula',
               2,
               u'basics:exer:formula1',
               u'basics:exer:formula1'),
              (u'Exercise 2: Combine text and numbers in output',
               2,
               u'basics:exer:printf1',
               u'basics:exer:printf1'),
              (u'Exercise 3: Program a while loop',
               2,
               u'basics:exer:while1',
               u'basics:exer:while1'),
              (u'Exercise 4: Create a list with a while loop',
               2,
               u'basics:exer:while2',
               u'basics:exer:while2'),
              (u'Exercise 5: Program a for loop',
               2,
               u'basics:exer:for1',
               u'basics:exer:for1'),
              (u'Exercise 6: Write a Python function',
               2,
               u'basics:exer:func1',
               u'basics:exer:func1'),
              (u'Exercise 7: Return three values from a Python function',
               2,
               u'basics:exer:func3',
               u'basics:exer:func3'),
              (u'Exercise 8: Plot a function',
               2,
               u'basics:exer:plot1',
               u'basics:exer:plot1'),
              (u'Exercise 9: Plot two functions',
               2,
               u'basics:exer:plot2',
               u'basics:exer:plot2'),
              (u'Exercise 10: Measure the efficiency of vectorization',
               2,
               u'basics:exer:timeit',
               u'basics:exer:timeit')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="basics.html">A short introduction to scientific Python programming</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._basics000.html#table_of_contents" style="font-size: 80%;"><b>Table of contents</b></a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:basic:objects" style="font-size: 80%;"><b>Variables, loops, lists, and arrays</b></a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:accesspy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Getting access to Python</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#___sec2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mac and Windows</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#___sec3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ubuntu</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#___sec4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Web access</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#___sec5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Mathematical example</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:formula:eval" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A program for evaluating a formula</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:printf" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Formatted output with text and numbers</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:while" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;While loops</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:list" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Lists</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:for" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;For loops</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:numpy" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Arrays</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:math" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Mathematical functions</a></li>
     <!-- navigation toc: --> <li><a href="._basics001.html#basics:plot" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Plotting</a></li>
     <!-- navigation toc: --> <li><a href="._basics002.html#basics:func:branching" style="font-size: 80%;"><b>Functions and branching</b></a></li>
     <!-- navigation toc: --> <li><a href="._basics002.html#basics:func" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Functions</a></li>
     <!-- navigation toc: --> <li><a href="._basics002.html#basics:formula:piecewise" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A more general mathematical formula</a></li>
     <!-- navigation toc: --> <li><a href="._basics002.html#basics:if" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;If tests</a></li>
     <!-- navigation toc: --> <li><a href="._basics002.html#___sec18" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using the <code>where</code> function</a></li>
     <!-- navigation toc: --> <li><a href="._basics002.html#___sec19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using array indexing</a></li>
     <!-- navigation toc: --> <li><a href="._basics002.html#___sec20" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Array view versus array copying</a></li>
     <!-- navigation toc: --> <li><a href="._basics002.html#___sec21" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Linear systems</a></li>
     <!-- navigation toc: --> <li><a href="._basics003.html#basics:files" style="font-size: 80%;"><b>Files</b></a></li>
     <!-- navigation toc: --> <li><a href="._basics003.html#___sec23" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;File reading</a></li>
     <!-- navigation toc: --> <li><a href="._basics003.html#___sec24" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;File writing</a></li>
     <!-- navigation toc: --> <li><a href="._basics004.html#basics:class" style="font-size: 80%;"><b>Classes</b></a></li>
     <!-- navigation toc: --> <li><a href="._basics004.html#___sec26" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A very simple class</a></li>
     <!-- navigation toc: --> <li><a href="._basics004.html#___sec27" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A class for representing a mathematical function</a></li>
     <!-- navigation toc: --> <li><a href="._basics004.html#___sec28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The class code</a></li>
     <!-- navigation toc: --> <li><a href="._basics004.html#___sec29" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dissection</a></li>
     <!-- navigation toc: --> <li><a href="#basics:exer" style="font-size: 80%;"><b>Exercises</b></a></li>
     <!-- navigation toc: --> <li><a href="#basics:exer:formula1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 1: Program a formula</a></li>
     <!-- navigation toc: --> <li><a href="#basics:exer:printf1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 2: Combine text and numbers in output</a></li>
     <!-- navigation toc: --> <li><a href="#basics:exer:while1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 3: Program a while loop</a></li>
     <!-- navigation toc: --> <li><a href="#basics:exer:while2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 4: Create a list with a while loop</a></li>
     <!-- navigation toc: --> <li><a href="#basics:exer:for1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 5: Program a for loop</a></li>
     <!-- navigation toc: --> <li><a href="#basics:exer:func1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 6: Write a Python function</a></li>
     <!-- navigation toc: --> <li><a href="#basics:exer:func3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 7: Return three values from a Python function</a></li>
     <!-- navigation toc: --> <li><a href="#basics:exer:plot1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 8: Plot a function</a></li>
     <!-- navigation toc: --> <li><a href="#basics:exer:plot2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 9: Plot two functions</a></li>
     <!-- navigation toc: --> <li><a href="#basics:exer:timeit" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 10: Measure the efficiency of vectorization</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0005"></a>
<!-- !split -->

<h1 id="basics:exer" class="anchor">Exercises</h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="basics:exer:formula1" class="anchor">Exercise 1: Program a formula</h2>

<p>
<b>a)</b>
Make a simplest possible
Python program that calculates and prints the value of the
formula

$$ y = 6x^2 + 3x + 2,\]
for $x=2$.
$$

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_1_1" style="font-size: 80%;"></a>
<a href="#exer_1_1" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_1_1">

<p>
The complete program reads

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>x <span style="color: #666666">=</span> <span style="color: #666666">2</span>
y <span style="color: #666666">=</span> <span style="color: #666666">6*</span>x<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #666666">3*</span>x <span style="color: #666666">+</span> <span style="color: #666666">2</span>
<span style="color: #008000; font-weight: bold">print</span>(y)
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Make a Python function that takes \( x \) as argument and returns \( y \).
Call the function for \( x=2 \) and print the answer.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_1_2" style="font-size: 80%;"></a>
<a href="#exer_1_2" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_1_2">

<p>
Code:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">6*</span>x<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #666666">3*</span>x <span style="color: #666666">+</span> <span style="color: #666666">2</span>

y <span style="color: #666666">=</span> f(<span style="color: #666666">2</span>)
<span style="color: #008000; font-weight: bold">print</span>(y)
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="basics:exer:printf1" class="anchor">Exercise 2: Combine text and numbers in output</h2>

<p>
Let \( y=x^2 \). Make a program that writes the text

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>y(2.550)=6.502
</pre></div>
<p>
if \( x=2.55 \). The values of \( x \) and \( y \) should be written with three
decimals. Run the program for \( x=\pi \) too (the value if \( \pi \) is available
as the variable <code>pi</code> in the <code>math</code> module).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_2_1" style="font-size: 80%;"></a>
<a href="#exer_2_1" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_2_1">

<p>
Here is the code:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>x <span style="color: #666666">=</span> <span style="color: #666666">2.55</span>
y <span style="color: #666666">=</span> x<span style="color: #666666">**2</span>
<span style="color: #008000; font-weight: bold">print</span>(<span style="color: #BA2121">&#39;y(</span><span style="color: #BB6688; font-weight: bold">%.3f</span><span style="color: #BA2121">)=</span><span style="color: #BB6688; font-weight: bold">%.3f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (x, y))
</pre></div>
<p>
Changing \( x=2.55 \) to \( x=\pi \),

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> pi
x <span style="color: #666666">=</span> pi
y <span style="color: #666666">=</span> x<span style="color: #666666">**2</span>
<span style="color: #008000; font-weight: bold">print</span>(<span style="color: #BA2121">&#39;y(</span><span style="color: #BB6688; font-weight: bold">%.3f</span><span style="color: #BA2121">)=</span><span style="color: #BB6688; font-weight: bold">%.3f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (x, y))
</pre></div>
<p>
gives the output <code>y(3.142)=9.870</code>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="basics:exer:while1" class="anchor">Exercise 3: Program a while loop</h2>

<p>
Define a sequence of numbers,

$$ x_n = n^2 + 1,$$

for integers \( n=0,1,2,\ldots,N \).
Write a program that prints out \( x_n \) for \( n=0,1,\ldots,20 \) using
a while loop.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_3_1" style="font-size: 80%;"></a>
<a href="#exer_3_1" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_3_1">

<p>
Complete program:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>n <span style="color: #666666">=</span> <span style="color: #666666">0</span>
<span style="color: #008000; font-weight: bold">while</span> n <span style="color: #666666">&lt;=</span> <span style="color: #666666">20</span>:
    x_n <span style="color: #666666">=</span> n<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">print</span>(<span style="color: #BA2121">&#39;x</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">=</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (n, x_n))
    n <span style="color: #666666">=</span> n <span style="color: #666666">+</span> <span style="color: #666666">1</span>
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="basics:exer:while2" class="anchor">Exercise 4: Create a list with a while loop</h2>

<p>
Store all the \( x_n \) values computed in <a href="#basics:exer:while1">Exercise 3: Program a while loop</a>
in a list (using a while loop). Print the entire list (as one object).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_4_1" style="font-size: 80%;"></a>
<a href="#exer_4_1" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_4_1">

<p>
Code:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>n <span style="color: #666666">=</span> <span style="color: #666666">0</span>
x <span style="color: #666666">=</span> []  <span style="color: #408080; font-style: italic"># the x_n values</span>
<span style="color: #008000; font-weight: bold">while</span> n <span style="color: #666666">&lt;=</span> <span style="color: #666666">20</span>:
    x<span style="color: #666666">.</span>append(n<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #666666">1</span>)
    n <span style="color: #666666">=</span> n <span style="color: #666666">+</span> <span style="color: #666666">1</span>
<span style="color: #008000; font-weight: bold">print</span>(x)
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="basics:exer:for1" class="anchor">Exercise 5: Program a for loop</h2>

<p>
Do <a href="#basics:exer:while2">Exercise 4: Create a list with a while loop</a>, but use a for loop.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_5_1" style="font-size: 80%;"></a>
<a href="#exer_5_1" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_5_1">

<p>
Code:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>x <span style="color: #666666">=</span> []
<span style="color: #008000; font-weight: bold">for</span> n <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">21</span>):
    x<span style="color: #666666">.</span>append(n<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #666666">1</span>)
<span style="color: #008000; font-weight: bold">print</span>(x)
</pre></div>
<p>
One can also make the code shorter using a list comprehension:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>x <span style="color: #666666">=</span> [n<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #666666">1</span> <span style="color: #008000; font-weight: bold">for</span> n <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">21</span>)]
<span style="color: #008000; font-weight: bold">print</span>(x)
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="basics:exer:func1" class="anchor">Exercise 6: Write a Python function</h2>

<p>
Write a function <code>x(n)</code> for computing an element in the
sequence \( x_n=n^2+1 \). Call the function for \( n=4 \) and write
out the result.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_6_1" style="font-size: 80%;"></a>
<a href="#exer_6_1" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_6_1">

<p>
Code:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">x</span>(n):
    <span style="color: #008000; font-weight: bold">return</span> n<span style="color: #666666">^2</span> <span style="color: #666666">+</span> <span style="color: #666666">1</span>

<span style="color: #008000; font-weight: bold">print</span>(x(<span style="color: #666666">4</span>))
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="basics:exer:func3" class="anchor">Exercise 7: Return three values from a Python function</h2>

<p>
Write a Python function that evaluates the mathematical functions
\( f(x)=\cos(2x) \), \( f'(x)=-2\sin(2x) \), and \( f''(x)=-4\cos(2x) \). Return
these three values. Write out the results of these values for \( x=\pi \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_7_1" style="font-size: 80%;"></a>
<a href="#exer_7_1" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_7_1">

<p>
Code:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> sin, cos, pi

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">deriv2</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> cos(<span style="color: #666666">2*</span>x), <span style="color: #666666">-2*</span>sin(<span style="color: #666666">2*</span>x), <span style="color: #666666">-4*</span>cos(<span style="color: #666666">2*</span>x)

f, df, d2f <span style="color: #666666">=</span> deriv2(x<span style="color: #666666">=</span>pi)
<span style="color: #008000; font-weight: bold">print</span>(f, df, d2f)
</pre></div>
<p>
Running the program gives

<p>

<!-- code=text (!bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>Terminal&gt; python deriv2.py
1.0 4.89858719659e-16 -4.0
</pre></div>
<p>
as expected.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="basics:exer:plot1" class="anchor">Exercise 8: Plot a function</h2>

<p>
Make a program that plots the function \( g(y)=e^{-y}\sin (4y) \) for
\( y\in [0,4] \) using a red solid line.
Use 500 intervals for evaluating points in \( [0,4] \).
Store all coordinates and values in arrays. Set labels on the
axis and use a title &quot;Damped sine wave&quot;.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_8_1" style="font-size: 80%;"></a>
<a href="#exer_8_1" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_8_1">

<p>
Appropriate code is

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">import</span> exp, sin  <span style="color: #408080; font-style: italic"># avoid np. prefix in g(y) formula</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">g</span>(y):
    <span style="color: #008000; font-weight: bold">return</span> exp(<span style="color: #666666">-</span>y)<span style="color: #666666">*</span>sin(<span style="color: #666666">4*</span>y)

y <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">4</span>, <span style="color: #666666">501</span>)
values <span style="color: #666666">=</span> g(y)
plt<span style="color: #666666">.</span>figure()
plt<span style="color: #666666">.</span>plot(y, values, <span style="color: #BA2121">&#39;r-&#39;</span>)
plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;$y$&#39;</span>); plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;$g(y)$&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">&#39;Damped sine wave&#39;</span>)
plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp.png&#39;</span>); plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp.pdf&#39;</span>)
plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
<br /><br /><center><p><img src="fig-bumpy/plot_exer1.png" align="bottom" width=500></p></center><br /><br />

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="basics:exer:plot2" class="anchor">Exercise 9: Plot two functions</h2>

<p>
As <a href="#basics:exer:plot2">Exercise 9: Plot two functions</a>, but add a black dashed
curve for the function
\( h(y)=e^{-\frac{3}{2}y}\sin (4y) \). Include a legend for each
curve (with names <code>g</code> and <code>h</code>).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_9_1" style="font-size: 80%;"></a>
<a href="#exer_9_1" data-toggle="collapse">
<b>Solution.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_9_1">

<p>
Here is the program:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">import</span> exp, sin  <span style="color: #408080; font-style: italic"># avoid np. prefix in g(y) and h(y)</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">g</span>(y):
    <span style="color: #008000; font-weight: bold">return</span> exp(<span style="color: #666666">-</span>y)<span style="color: #666666">*</span>sin(<span style="color: #666666">4*</span>y)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">h</span>(y):
    <span style="color: #008000; font-weight: bold">return</span> exp(<span style="color: #666666">-</span>(<span style="color: #666666">3./2</span>)<span style="color: #666666">*</span>y)<span style="color: #666666">*</span>sin(<span style="color: #666666">4*</span>y)

y <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">4</span>, <span style="color: #666666">501</span>)
plt<span style="color: #666666">.</span>figure()
plt<span style="color: #666666">.</span>plot(y, g(y), <span style="color: #BA2121">&#39;r-&#39;</span>, y, h(y), <span style="color: #BA2121">&#39;k--&#39;</span>)
plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;$y$&#39;</span>); plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;$g(y)$&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">&#39;Damped sine wave&#39;</span>)
plt<span style="color: #666666">.</span>legend([<span style="color: #BA2121">&#39;g&#39;</span>, <span style="color: #BA2121">&#39;h&#39;</span>])
plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp.png&#39;</span>); plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp.pdf&#39;</span>)
plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
<br /><br /><center><p><img src="fig-bumpy/plot_exer2.png" align="bottom" width=500></p></center><br /><br />

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="basics:exer:timeit" class="anchor">Exercise 10: Measure the efficiency of vectorization</h2>

<p>
<a href="http://ipython.org/" target="_self">IPython</a> an enhanced interactive shell
for doing computing with Python. IPython has some user-friendly functionality
for quick testing of the efficiency of different Python constructions.
Start IPython by writing <code>ipython</code> in a terminal window.
The interactive session below demonstrates how we can use the
timer feature <code>%timeit</code> to measure the CPU time required by
computing \( \sin (x) \), where \( x \) is an array of 1M elements, using
scalar computing with a loop (function <code>sin_func</code>) and vectorized
computing using the <code>sin</code> function from <code>numpy</code>.

<p>

<!-- code=python (!bc ipy) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>In [<span style="color: #666666">1</span>]: <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>

In [<span style="color: #666666">2</span>]: n <span style="color: #666666">=</span> <span style="color: #666666">1000000</span>

In [<span style="color: #666666">3</span>]: x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">1</span>, n<span style="color: #666666">+1</span>)

In [<span style="color: #666666">4</span>]: <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">sin_func</span>(x):
   <span style="color: #666666">...</span>:     r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros_like(x)  <span style="color: #408080; font-style: italic"># result</span>
   <span style="color: #666666">...</span>:     <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(x)):
   <span style="color: #666666">...</span>:         r[i] <span style="color: #666666">=</span> np<span style="color: #666666">.</span>sin(x[i])
   <span style="color: #666666">...</span>:     <span style="color: #008000; font-weight: bold">return</span> r
   <span style="color: #666666">...</span>:

In [<span style="color: #666666">5</span>]: <span style="color: #666666">%</span>timeit y <span style="color: #666666">=</span> sin_func(x)
<span style="color: #666666">1</span> loops, best of <span style="color: #666666">3</span>: <span style="color: #666666">2.68</span> s per loop

In [<span style="color: #666666">6</span>]: <span style="color: #666666">%</span>timeit y <span style="color: #666666">=</span> np<span style="color: #666666">.</span>sin(x)
<span style="color: #666666">10</span> loops, best of <span style="color: #666666">3</span>: <span style="color: #666666">40.1</span> ms per loop
</pre></div>
<p>
Here, <code>%timeit</code> ran our function once, but the vectorized function
10 times. The most relevant CPU times measured are listed, and we
realize that
the vectorized code is \( 2.68/(40.1/1000)\approx 67 \) times faster
than the loop-based scalar code.

<p>
Use the recipe above to investigate the speed up of the
vectorized computation of the \( s(t) \) function in
the section <a href="._basics002.html#basics:func">Functions</a>.

<p>
<!-- factor 134 -->
<!-- --- end exercise --- -->

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._basics004.html">&laquo;</a></li>
  <li><a href="._basics000.html">1</a></li>
  <li><a href="._basics001.html">2</a></li>
  <li><a href="._basics002.html">3</a></li>
  <li><a href="._basics003.html">4</a></li>
  <li><a href="._basics004.html">5</a></li>
  <li class="active"><a href="._basics005.html">6</a></li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

